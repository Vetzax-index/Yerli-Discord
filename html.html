<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Benzeri Uygulama</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Sol Panel: Sunucu ve Kanallar -->
        <div class="sidebar">
            <div class="server-name">ğŸº cCcCc ğŸº</div>
            <div class="channel-section">
                <h2 class="section-title">Ses KanallarÄ±</h2>
                <div class="channels" id="channelsList"></div>
                <button id="createChannelBtn" onclick="createChannel()">â• Kanal OluÅŸtur</button>
            </div>
        </div>
        
        <!-- Ana Panel: Kanal DetaylarÄ± ve MesajlaÅŸma -->
        <div class="main-content">
            <div class="header">
                <h1>Yerli ve Milli Discord ğŸ‡¹ğŸ‡·ğŸº</h1>
            </div>

            <div class="user-list-section">
                <h2>Kanala BaÄŸlÄ± KullanÄ±cÄ±lar:</h2>
                <ul id="userList" class="user-list"></ul>
            </div>

            <div class="message-section">
                <h2>Mesajlar:</h2>
                <div id="messageList" class="message-list"></div>
                <div class="message-input">
                    <input type="text" id="messageInput" placeholder="MesajÄ±nÄ±zÄ± yazÄ±n...">
                    <button onclick="sendMessage()">GÃ¶nder</button>
                </div>
            </div>

            <div id="userProfile" class="user-profile"></div> <!-- KullanÄ±cÄ± profili alanÄ± -->
        </div>

        <!-- SaÄŸ Panel: Ãœyeler -->
        <div class="right-panel">
            <h2>Aktif Ãœyeler</h2>
            <ul id="activeUsers" class="active-users"></ul>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let currentRoom;

        // Kanal oluÅŸturma fonksiyonu
        function createChannel() {
            const channelName = prompt("Kanal ismini girin:");
            if (channelName) {
                const channelDiv = document.createElement('div');
                channelDiv.classList.add('channel');
                channelDiv.onclick = () => joinChannel(channelName);
                channelDiv.innerHTML = `<span class="channel-icon">ğŸ”Š</span> ${channelName}`;
                
                document.getElementById('channelsList').appendChild(channelDiv);
                alert(`Kanal oluÅŸturuldu: ${channelName}`);
            }
        }

        // Kanal seÃ§imi ve baÄŸlanma iÅŸlemi
        function joinChannel(channelName) {
            if (currentRoom) {
                socket.leave(currentRoom);  // Ã–nceki odadan ayrÄ±l
            }
            currentRoom = channelName;
            socket.emit('join-room', channelName);

            // KullanÄ±cÄ± listesi temizleniyor
            document.getElementById('userList').innerHTML = '';
            document.getElementById('messageList').innerHTML = ''; // Mesaj listesini temizle
            document.getElementById('userProfile').innerHTML = ''; // KullanÄ±cÄ± profilini temizle
            document.getElementById('activeUsers').innerHTML = ''; // Aktif kullanÄ±cÄ± listesini temizle

            alert(`BaÄŸlanÄ±ldÄ±: ${channelName}`);

            // Sunucudan gelen kullanÄ±cÄ± listesi gÃ¼ncellemesi
            socket.on('update-users', (userList) => {
                const userListElement = document.getElementById('userList');
                userListElement.innerHTML = ''; // Listeyi temizle
                userList.forEach(userId => {
                    const li = document.createElement('li');
                    li.textContent = `KullanÄ±cÄ±: ${userId}`;
                    userListElement.appendChild(li);
                });

                // Aktif kullanÄ±cÄ±larÄ± saÄŸ panelde gÃ¶ster
                const activeUsersElement = document.getElementById('activeUsers');
                activeUsersElement.innerHTML = ''; // Aktif kullanÄ±cÄ±larÄ± temizle
                userList.forEach(userId => {
                    const li = document.createElement('li');
                    li.textContent = userId;
                    activeUsersElement.appendChild(li);
                });

                // Ä°lk kullanÄ±cÄ±nÄ±n profilini gÃ¶ster
                if (userList.length > 0) {
                    showUserProfile(userList[0]);
                }
            });

            // Mesaj gÃ¼ncellemeleri
            socket.on('receive-message', (message) => {
                const messageListElement = document.getElementById('messageList');
                const messageElement = document.createElement('div');
                messageElement.textContent = message;
                messageListElement.appendChild(messageElement);
            });
        }

        // KullanÄ±cÄ± profili gÃ¶sterme fonksiyonu
        function showUserProfile(userId) {
            const userProfileElement = document.getElementById('userProfile');
            userProfileElement.innerHTML = `<h3>Profil: ${userId}</h3>
                                            <p>Bu kullanÄ±cÄ± burada aktif.</p>`;
        }

        // Mesaj gÃ¶nderme fonksiyonu
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value;
            if (message && currentRoom) {
                socket.emit('send-message', { room: currentRoom, message: message });
                messageInput.value = ''; // Mesaj kutusunu temizle
            }
        }
    </script>
</body>
</html>
